<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Michaelsoft Binbows Bonzi Edition</title>
<style>
  body {
    background-color: #2E004F; 
    color: #FF80FF; 
    font-family: monospace;
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    padding: 10px;
  }
  #terminal { flex: 1; overflow-y: auto; }
  #input {
    width: 100%;
    border: none;
    outline: none;
    background: #2E004F;
    color: #FF80FF;
    font-family: monospace;
    font-size: 16px;
  }
  .line { margin: 0; }
  #gameContainer {
    position: relative;
    width: 200px;
    height: 100px;
    background: #4B006F;
    margin-top: 5px;
  }
  #player { position: absolute; bottom: 0; width: 20px; height: 20px; background: #FF80FF; }
  .obstacle { position: absolute; width: 20px; height: 20px; background: #FF0000; }
</style>
</head>
<body>
<div id="terminal"></div>
<input id="input" autofocus placeholder="Type a command..." />

<script>
const terminal = document.getElementById('terminal');
const input = document.getElementById('input');

function printLine(text) {
  const line = document.createElement('div');
  line.className = 'line';
  line.textContent = text;
  terminal.appendChild(line);
  terminal.scrollTop = terminal.scrollHeight;
}

// Fake file system
const fakeFiles = {
  "readme.txt": "Welcome to Michaelsoft Binbows Bonzi Edition!\nEnjoy your stay.",
  "bonzi.txt": "Bonzi says: Hello, human!",
  "game.txt": "Mini Dodger Game is available via 'play' command."
};

// Mini Dodger game
function startGame() {
  printLine("Starting Dodger Game! Use left/right arrows to move '@'.");
  const gameContainer = document.createElement('div');
  gameContainer.id = 'gameContainer';
  terminal.appendChild(gameContainer);

  let playerPos = 90;
  const player = document.createElement('div');
  player.id = 'player';
  player.style.left = playerPos + 'px';
  gameContainer.appendChild(player);

  let obstacles = [];
  let score = 0;
  let gameOver = false;

  function createObstacle() {
    const obs = document.createElement('div');
    obs.className = 'obstacle';
    obs.style.top = '0px';
    obs.style.left = Math.floor(Math.random() * 10) * 20 + 'px';
    gameContainer.appendChild(obs);
    obstacles.push(obs);
  }

  function moveObstacles() {
    obstacles.forEach((obs, i) => {
      let top = parseInt(obs.style.top);
      top += 5;
      obs.style.top = top + 'px';
      if(top >= 80 && Math.abs(parseInt(obs.style.left) - playerPos) < 20) gameOver = true;
      if(top > 100) {
        obs.remove();
        obstacles.splice(i, 1);
        if(!gameOver) score++;
      }
    });
  }

  const gameLoop = setInterval(() => {
    if(gameOver) {
      clearInterval(gameLoop);
      printLine("Game Over! Score: " + score);
      return;
    }
    if(Math.random() < 0.1) createObstacle();
    moveObstacles();
  }, 100);

  document.addEventListener('keydown', e => {
    if(e.key === 'ArrowLeft') playerPos = Math.max(0, playerPos - 20);
    if(e.key === 'ArrowRight') playerPos = Math.min(180, playerPos + 20);
    player.style.left = playerPos + 'px';
  });

  return '';
}

// Commands
const commands = {
  help: () => "Commands: " + Object.keys(commands).join(", "),
  clear: () => { terminal.innerHTML = ''; return ''; },
  cls: () => { terminal.innerHTML = ''; return ''; },
  about: "Michaelsoft Binbows Bonzi Edition – Browser OS Simulator!",
  time: () => new Date().toLocaleTimeString(),
  date: () => new Date().toLocaleDateString(),
  whoami: () => "User: Bonzi",
  play: startGame,
  game: startGame,
  echo: (text) => text || "Usage: echo [text]",
  rand: () => Math.floor(Math.random() * 100),
  flip: () => Math.random() < 0.5 ? "Heads" : "Tails",
  motd: () => "Have fun with Michaelsoft Binbows today!",
  color: (text) => {
    const [fg, bg] = (text || "").split(" ");
    if(fg) terminal.style.color = fg;
    if(bg) document.body.style.backgroundColor = bg;
    return `Colors updated (fg=${fg}, bg=${bg})`;
  },
  calc: (text) => {
    try { return eval(text); } 
    catch(e){ return "Invalid expression"; }
  },
  dir: () => Object.keys(fakeFiles).join("\n"),
  ls: () => Object.keys(fakeFiles).join("\n"),
  open: (filename) => {
    if(filename in fakeFiles) return fakeFiles[filename];
    else return "File not found: " + filename;
  },
  shutdown: () => { printLine("Shutting down..."); return "Goodbye!"; },
  reboot: () => { printLine("Rebooting..."); location.reload(); return ''; },
  banner: () => `
  ███╗   ███╗██╗ ██████╗ ███████╗
  ████╗ ████║██║██╔═══██╗██╔════╝
  ██╔████╔██║██║██║   ██║███████╗
  ██║╚██╔╝██║██║██║   ██║╚════██║
  ██║ ╚═╝ ██║██║╚██████╔╝███████║
  ╚═╝     ╚═╝╚═╝ ╚═════╝ ╚══════╝
  `,
  fortune: () => {
    const messages = [
      "Bonzi says: Have a great day!",
      "Tip: Dodge the red blocks!",
      "Remember: Purple rules!",
      "Fun fact: Bonzi was here!"
    ];
    return messages[Math.floor(Math.random() * messages.length)];
  }
};

// Input handler
input.addEventListener('keydown', e => {
  if(e.key === 'Enter') {
    const fullInput = input.value.trim();
    printLine("> " + fullInput);
    input.value = '';

    const parts = fullInput.split(" ");
    const cmd = parts[0].toLowerCase();
    const args = parts.slice(1).join(" ");

    if(cmd in commands) {
      const result = typeof commands[cmd] === 'function' ? commands[cmd](args) : commands[cmd];
      if(result) printLine(result);
    } else {
      printLine("Unknown command: " + cmd);
    }
  }
});

// Welcome message
printLine("Welcome to Michaelsoft Binbows Bonzi Edition!");
printLine("Type 'help' for commands.");
</script>
</body>
</html>
